set -g fish_greeting

set -gx EDITOR cursor
set -gx VISUAL cursor

{{- if .is_macos }}
if test -f /opt/homebrew/bin/brew
    eval (/opt/homebrew/bin/brew shellenv)
else if test -f /usr/local/bin/brew
    eval (/usr/local/bin/brew shellenv)
end
{{- else if .is_linux }}
if test -f /home/linuxbrew/.linuxbrew/bin/brew
    eval (/home/linuxbrew/.linuxbrew/bin/brew shellenv)
else if test -f ~/.linuxbrew/bin/brew
    eval (~/.linuxbrew/bin/brew shellenv)
end
{{- end }}

fish_add_path ~/.cargo/bin
fish_add_path ~/.local/bin

# Note: .local/bin/env is a bash script and cannot be sourced in fish
# If you need to use it, run it manually or convert it to a fish script

# Google Cloud SDK
if set -q HOMEBREW_PREFIX
    if test -f "$HOMEBREW_PREFIX/Caskroom/google-cloud-cli/latest/google-cloud-sdk/path.fish.inc"
        source "$HOMEBREW_PREFIX/Caskroom/google-cloud-cli/latest/google-cloud-sdk/path.fish.inc"
    else if test -f "$HOMEBREW_PREFIX/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/path.fish.inc"
        source "$HOMEBREW_PREFIX/Caskroom/google-cloud-sdk/latest/google-cloud-sdk/path.fish.inc"
    else if test -f "$HOMEBREW_PREFIX/share/google-cloud-sdk/path.fish.inc"
        source "$HOMEBREW_PREFIX/share/google-cloud-sdk/path.fish.inc"
    end
end

# Fallback for manual install
if test -f ~/google-cloud-sdk/path.fish.inc
    source ~/google-cloud-sdk/path.fish.inc
end

# Conda initialization
if set -q HOMEBREW_PREFIX
    if test -f "$HOMEBREW_PREFIX/Caskroom/miniconda/base/etc/fish/conf.d/conda.fish"
        source "$HOMEBREW_PREFIX/Caskroom/miniconda/base/etc/fish/conf.d/conda.fish"
    end
end

if test -f ~/miniconda3/etc/fish/conf.d/conda.fish
    source ~/miniconda3/etc/fish/conf.d/conda.fish
end

{{- if .is_macos }}
# pnpm
set -gx PNPM_HOME "$HOME/Library/pnpm"
fish_add_path $PNPM_HOME
{{- end }}

# uv shell completion
if type -q uv
    uv generate-shell-completion fish | source
end

# Starship prompt
if type -q starship
    starship init fish | source
end

# Aliases
alias ll="ls -lah"
alias g="git"
alias c="cursor"
alias py="python3"
